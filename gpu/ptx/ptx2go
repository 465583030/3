#! /bin/bash
ptxfile=$1
gofile=$2
varname=$3
tmpfile=$gofile.tmp
VARNAME="${varname^^}"

echo "package ptx" > $tmpfile
echo "//This file is auto-generated. Editing is futile." >>$tmpfile
echo "" >>$tmpfile
echo "func init(){Code[\""$varname"\"]=" $VARNAME "}">> $tmpfile
echo "const" $VARNAME "=" "\`" >> $tmpfile
cat $tmpfile $ptxfile > $gofile
rm $tmpfile
echo "\`" >> $gofile
gofmt -w $gofile
