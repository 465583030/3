/*
	This test lets uniaxial anisotropy compete against the external field.
	Reference values obtained with OOMMF.
*/

	setgridsize(64, 64, 1)
	setcellsize(4e-9, 4e-9, 2e-9)

	Msat  = 1100e3
	Aex   = 13e-12
	alpha = 0.2
	Ku1   = vector(0.5e6, 0, 0)
	M     = uniform(1, 1, 0)

	savetable(10e-12)

	// Apply some fields and verify the relaxed my against OOMMF values.

	B_ext = vector(0, 0.00, 0)
	run(1e-9)
	expect("my", average(m)[1], 0.000, 1e-3)

	B_ext = vector(0, 0.01, 0)
	run(1e-9)
	expect("my", average(m)[1], 0.011, 1e-3)

	B_ext = vector(0, 0.03, 0)
	run(1e-9)
	expect("my", average(m)[1], 0.033, 1e-3)

	B_ext = vector(0, 0.10, 0)
	run(1e-9)
	expect("my", average(m)[1], 0.110, 1e-3)

	B_ext = vector(0, 0.30, 0)
	run(1e-9)
	expect("my", average(m)[1], 0.331, 1e-3)

