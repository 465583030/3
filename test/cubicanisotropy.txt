/*
	Test cubic anisotropy.
	todo: verify against OOMMF values.
*/

	setgridsize(64, 64, 1)
	setcellsize(4e-9, 4e-9, 2e-9)

	Aex   = 13e-12
	alpha = 1
	M     = uniform(1, 1, 0)
	
	// define some regions to make sure anisotropy is applied everywhere
	// (when using Ku1 = ... syntax)
	defregion(2, cylinder(100e-9, 100e-9))
	defregion(3, rect(100e-9, 20e-9))
	
	// Test output
	save(Kc1)
	save(AnisC1)
	save(AnisC2)
	save(B_anis)
	
	AnisC1 = vector(1, 0, 0)
	AnisC2 = vector(0, 1, 0)
	Kc1   = 0.5e6

	Msat  = 1100e3

	B_ext = vector(0, 0.00, 0)
	run(1e-9)
	print("my", average(m)[1])


